<!DOCTYPE html>
<html>
  <head>
    <title>My Basic Website</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/speech-commands"></script>
  </head>
  <body>
    <header>
      <h1>Welcome to My Website</h1>
    </header>

    <nav>
      <ul>
        <li><a href="page1.html">Page 1</a></li>
        <li><a href="page2.html">Page 2</a></li>
        <li><a href="page3.html">Page 3</a></li>
        <li><a href="page4.html">Page 4</a></li>
        <li><a href="page5.html">Page 5</a></li>
        <li><a href="page6.html">Page 6</a></li>
        <li><a href="page7.html">Page 7</a></li>
        <li><a href="page8.html">Page 8</a></li>
        <li><a href="page9.html">Page 9</a></li>
        <li><a href="page10.html">Page 10</a></li>
      </ul>
    </nav>

    <main>
      <h1>Speech Command Recognition</h1>
      <button id="toggleRecognition">Start Recognition</button>

      <div id="classificationResult" style="margin-top: 20px">
        <h2>Classification Result:</h2>
        <p id="resultText">No result yet</p>
      </div>

      <script>
        let recognizer;
        let listening = false;

        async function initializeRecognizer() {
          recognizer = await speechCommands.create("BROWSER_FFT");
          await recognizer.ensureModelLoaded();
          console.log(recognizer.wordLabels());
        }

        const toggleButton = document.getElementById("toggleRecognition");

        toggleButton.addEventListener("click", async () => {
          if (!recognizer) {
            await initializeRecognizer();
          }

          toggleButton.disabled = true;

          if (listening) {
            recognizer.stopListening();
            listening = false;
            toggleButton.textContent = "Start Recognition";
            toggleButton.disabled = false;
          } else {
            try {
              recognizer.listen(
                (result) => {
                    
                  const scores = result.scores;
                  const labels = recognizer.wordLabels();
                  const highestLabelIndex = scores.indexOf(Math.max(...scores));
                  const highestLabel = labels[highestLabelIndex];

                  document.getElementById(
                    "resultText"
                  ).textContent = `Most probable class: ${highestLabel}`;
                },
                {
                  includeSpectrogram: true,
                  probabilityThreshold: 0.75,
                }
              );

              listening = true;
              toggleButton.textContent = "Stop Recognition";
            } catch (error) {
              console.error("Error in speech recognition: ", error);
            } finally {
              toggleButton.disabled = false;
            }
          }
        });
      </script>
    </main>
  </body>
</html>
